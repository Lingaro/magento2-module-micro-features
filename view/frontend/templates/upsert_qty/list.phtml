<?php

/**
 * Copyright Â© 2023 Lingaro sp. z o.o. All rights reserved.
 * See LICENSE for license details.
 */

declare(strict_types=1);

/** @var \Magento\Framework\View\Element\Template $block */
/** @var \Magento\Framework\Escaper $escaper */
/** @var \Lingaro\MicroFeatures\ViewModel\UpsertQtyInitializer $viewModel */
$viewModel = $block->getViewModel();
?>
<?php if ($viewModel->getProduct() && $viewModel->isEnabled() && $viewModel->getProduct()->isSaleable()): ?>
    <?php $targetSelector = 'form[data-product-sku="'
        . $viewModel->getProduct()->getSku() . '"] .action.tocart.primary'; ?>
<div data-mage-init='<?= $escaper->escapeHtmlAttr($viewModel->getJsonConfig($targetSelector)) ?>'></div>
    <style>
        <?= /* @noEscape */ $targetSelector ?> {
            display: none;
        }
    </style>
<?php endif; ?>
